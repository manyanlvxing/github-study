{"version":3,"sources":["wechat.js"],"names":["wechat","userInfo","openid","session_key","link_key","timestamp","pid","server_id","dataList","rewardedVideoAd","loadVideoSuccess","wx","setPreferredFramesPerSecond","showShareMenu","successCB","res","data","status","msg","gg","sdkMgr","JSSaveLoginInfo","persist","showTip","length","i","postLoginData","__inviterInfo","request","url","method","inviter","success","undefined","bind","login","code","cc","log","conf","numerical","openPackage","channel_key","channel","substr","fail","errMsg","params","sys","os","OS_IOS","showConfirm","JSON","parse","PLAYER_ID","CHANNEL","SERVER_ID","price","Number","STORE_PRICE","storeName","STORE_NAME","console","paySuccessCB","name","getBalanceCB","isTest","test","errcode","errmsg","balance","requestMidasPayment","mode","env","offerId","currencyType","platform","zoneId","buyQuantity","errCode","checkSession","Math","floor","Date","gameParams","money","unit","goods","isShow","ball","screenSize","view","getFrameSize","createGameClubButton","icon","style","left","width","top","height","show","hide","datas","KVList","Array","isArray","push","key","value","stringify","score","pp","lv","setUserCloudStorage","KVDataList","triggerGC","sign","md5","hex_md5","getSystemInfo","info","adUnitId","createRewardedVideoAd","onError","onLoad","catch","load","then","watchRewardedVideoAd","successCb","failCb","onClose","isEnded","_parent","onTapCallBack","self","systemInfo","createButton","button","createUserInfoButton","type","image","windowWidth","windowHeight","lineHeight","backgroundColor","color","textAlign","fontSize","borderRadius","onTap","destroy","parent","getUserInfo","navigator","ua","userAgent","toLowerCase","indexOf","node","sprite","getComponent","Sprite","size","createImage","onload","texture","Texture2D","initWithElement","handleLoadedTexture","spriteFrame","SpriteFrame","src","module","exports"],"mappings":";;;;;;;;;;IACMA;AACF,sBAAc;AAAA;;AACV,aAAKC,QAAL,GAAgB,IAAhB;AACA,aAAKC,MAAL,GAAc,IAAd;AACA,aAAKC,WAAL,GAAmB,IAAnB;AACA,aAAKC,QAAL,GAAgB,IAAhB;AACA,aAAKC,SAAL,GAAiB,IAAjB;AACA,aAAKC,GAAL,GAAW,IAAX;AACA,aAAKC,SAAL,GAAiB,IAAjB;AACA,aAAKC,QAAL,GAAgB,EAAhB;AACA,aAAKC,eAAL,GAAuB,IAAvB;AACA,aAAKC,gBAAL,GAAwB,KAAxB;AACH;;;;+BACM;AACHC,eAAGC,2BAAH,CAA+B,EAA/B;AACAD,eAAGE,aAAH;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEH;;;iCACQ;AACL,mBAAO,IAAP;AACH;;;gCACO;AAAA;;AACJ,gBAAIC,YAAY,SAAZA,SAAY,CAACC,GAAD,EAAS;AACrB,oBAAIC,OAAOD,IAAIC,IAAf;AACA,oBAAIA,KAAKC,MAAL,KAAgB,GAApB,EAAyB;AACrB,wBAAIC,MAAMF,KAAKA,IAAf;AACA,0BAAKd,MAAL,GAAcgB,IAAIhB,MAAlB;AACA,0BAAKC,WAAL,GAAmBe,IAAIf,WAAvB;AACA,0BAAKC,QAAL,GAAgBc,IAAId,QAApB;AACA,0BAAKC,SA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","file":"wechat.js","sourceRoot":"..\\..\\..\\..\\..\\assets\\Script\\Common","sourcesContent":["\nclass wechat {\n    constructor() {\n        this.userInfo = null;\n        this.openid = null;\n        this.session_key = null;\n        this.link_key = null;\n        this.timestamp = null;\n        this.pid = null;\n        this.server_id = null;\n        this.dataList = [];\n        this.rewardedVideoAd = null;\n        this.loadVideoSuccess = false;\n    }\n    load() {\n        wx.setPreferredFramesPerSecond(30);\n        wx.showShareMenu();\n        // this.initRewardedVideoAd(\"xxxxx\");\n\n        // if (typeof wx.getUpdateManager === 'function') {\n        //     const updateManager = wx.getUpdateManager()\n        //     updateManager.onUpdateReady(() => {\n        //         wx.showModal({\n        //             title: '更新提示',\n        //             content: '新版本已经准备好，是否重启应用？',\n        //             success: function (res) {\n        //                 if (res.confirm) {\n        //                     // 新的版本已经下载好，调用 applyUpdate 应用新版本并重启\n        //                     updateManager.applyUpdate()\n        //                 }\n        //             }\n        //         })\n        //     })\n        // }\n\n        // let successCB = res => {\n        //     let data = res.data\n        //     wx.onShareAppMessage(() => {\n        //         return {\n        //             title: data.title,\n        //             imageUrl: data.url || 'https://tafang2h5-cdn.ios.gzyouai.com/sharedIcon.jpg',\n        //             query: 'type=1' + '&openid=' + this.openid + \"&link_key=\" + this.link_key + \"&server_id=\" + this.server_id + \"&pid=\" + this.pid\n        //         }\n        //     })\n        // }\n        // let failCB = () => {\n        //     initShareMessage()\n        // }\n        // function initShareMessage() {\n        //     wx.request({\n        //         url: 'https://tafang2center.ios.gzyouai.com:8091/service/wxSharedInfo',\n        //         success: successCB,\n        //         fail: failCB\n        //     })\n        // }\n        // initShareMessage()\n\n        // let launchCB = res => {\n        //     let query = res.query\n        //     let info = res.referrerInfo\n        //     let dataType = query.type || 0;\n\n        //     if (0 == dataType) {\n        //         let data = {}\n        //         data.scene = res.scene\n        //         if (info) data.appid = info.appId\n\n        //         if (query.source_id || (info && info.extraData)) {\n        //             if (query.source_id) {\n        //                 data.other = JSON.stringify(query)\n        //             } else if (info && info.extraData) {\n        //                 data.other = JSON.stringify(info.extraData)\n        //             } else {\n        //                 return;\n        //             }\n        //         } else {\n        //             data.other = '{\"source_id\":\"0000030025\"}'\n        //         }\n\n        //         if (this.link_key) {\n        //             this.postLoginData(data)\n        //         } else {\n        //             this.dataList.push(data)\n        //         }\n        //     } else if (1 == dataType) {\n        //         this.__inviterInfo = query\n        //     }\n        // }\n        // wx.getLaunchOptionsSync(launchCB)\n        // wx.onShow(launchCB)\n\n        // // var getUserInfo = ()=>{\n        // //     wx.getUserInfo({\n        // //         success: function(res) {\n        // //             this.userInfo = res.userInfo\n        // //         }\n        // //     });\n        // // }\n        // // wx.getSetting({\n        // //     success(res) {\n        // //         if (!res.authSetting['scope.userInfo']) {\n        // //             wx.authorize({\n        // //                 scope: 'wx.getUserInfo',\n        // //                 success() {\n        // //                     persist.showTip('授权成功！');\n        // //                     getUserInfo();\n        // //                 }\n        // //             })\n        // //         } else {\n        // //             persist.showTip('已授权！');\n        // //             getUserInfo();\n        // //         }\n        // //     }\n        // // })\n\n        // this.lastTime = Date.parse(new Date())\n        // //设置屏幕常亮\n        // wx.setKeepScreenOn({ keepScreenOn: true })\n        // //内存不足警告（仅安卓）\n        // wx.onMemoryWarning(() => {\n        //     let time = Date.parse(new Date())\n        //     if (this.lastTime && time - this.lastTime >= 1000) {\n        //         this.lastTime = time\n        //         this.gc()\n        //     }\n        // })\n\n    }\n    useSDK() {\n        return true;\n    }\n    login() {\n        var successCB = (res) => {\n            let data = res.data\n            if (data.status === \"0\") {\n                let msg = data.data\n                this.openid = msg.openid\n                this.session_key = msg.session_key\n                this.link_key = msg.link_key\n                this.timestamp = msg.timestamp\n                gg.sdkMgr.JSSaveLoginInfo(this.link_key, this.timestamp);\n                persist.showTip('登录成功！');\n                if (this.dataList.length > 0) {\n                    for (var i = 0; i < this.dataList.length; i++) {\n                        this.postLoginData(this.dataList[i])\n                    }\n                    this.dataList = [];\n                }\n                if (this.__inviterInfo) {\n                    wx.request({\n                        url: 'https://tafang2center.ios.gzyouai.com:8071/wx-invite',\n                        method: 'POST',\n                        data: {\n                            inviter: this.__inviterInfo,\n                            link_key: this.link_key\n                        },\n                        success: function () {\n                            this.__inviterInfo = undefined;\n                        }.bind(this)\n                    });\n                }\n            } else {\n                persist.showTip('登录验证失败！');\n            }\n        }\n        wx.login({\n            success: function (res) {\n                if (res.code) {\n                    cc.log('登录成功！' + res.code)\n                    let conf = gg.numerical.openPackage;\n                    let channel_key = conf.channel.substr(1, conf.channel.length - 1);\n                    wx.request({\n                        url: 'https://tafang2center.ios.gzyouai.com:8091/qfgn/login/weixin',\n                        data: {\n                            channel_key: channel_key,\n                            code: res.code\n                        },\n                        success: successCB,\n                        fail: function (res) {\n                            persist.showTip('请求验证失败！');\n                        }\n                    });\n                } else {\n                    persist.showTip('登录失败！' + res.errMsg);\n                    cc.log('登录失败！' + res.errMsg)\n                }\n            }\n        });\n    }\n    pay(params) {\n        if (cc.sys.os === cc.sys.OS_IOS) {\n            persist.showConfirm(\"<color=#000000>由于政策原因，IOS暂不支持充值，请使用安卓手机充值或者联系客服QQ：</c><color=#ff0000>123456789</c><color=#000000>，对您造成不便，请谅解～</c>\", null, \"提示\", false, true);\n            return;\n        }\n        // var notify_url = 'https://tafang2center.ios.gzyouai.com:8091/qfgn/order/weixin'\n        var data = JSON.parse(params)\n\n        var pid = data.PLAYER_ID\n        var channel_key = data.CHANNEL\n        var server_id = data.SERVER_ID\n        var price = Number(data.STORE_PRICE) * 10\n        var storeName = data.STORE_NAME\n\n        console.log(\"请求支付\")\n        var paySuccessCB = (res) => {\n            persist.showTip('支付成功！')\n            wx.request({\n                url: 'https://tafang2center.ios.gzyouai.com:8091/qfgn/confirm/weixin',\n                data: {\n                    openid: this.openid,\n                    session_key: this.session_key,\n                    pid: pid,\n                    channel_key: channel_key,\n                    server_id: server_id,\n                    price: price,\n                    name: storeName\n                },\n                success: function (res) {\n                    let data = res.data\n                    console.log(data)\n                    if (data == 'success') {\n                        persist.showTip('扣款成功！');\n                    } else {\n                        persist.showTip('扣款失败！');\n                    }\n                },\n                fail: function (res) {\n                    persist.showTip('请求扣款失败！');\n                }\n            });\n        }\n        var getBalanceCB = (res) => {\n            let isTest = res.data.test\n            let data = res.data.data\n            if (data.errcode != null && data.errcode != 0) {\n                persist.showTip(data.errmsg)\n            } else {\n                if (data.balance < price) {\n                    wx.requestMidasPayment({\n                        mode: 'game',\n                        env: isTest ? 1 : 0,\n                        offerId: '1450017632',\n                        currencyType: 'CNY',\n                        platform: 'android',\n                        zoneId: '1',\n                        buyQuantity: price,\n                        success: paySuccessCB,\n                        fail({ errMsg, errCode }) {\n                            // 支付失败\n                            console.log(errMsg, errCode)\n                            persist.showTip(errMsg);\n                        }\n                    })\n                } else {\n                    paySuccessCB()\n                }\n            }\n        }\n        // var getTokenCB = (res) => {\n        //     let data = res.data\n        //     this.access_token = data.access_token\n        //     wx.request({\n        //         url : 'https://tafang2center.ios.gzyouai.com:8091/service/wxGetBalance',\n        //         data : {\n        //             token : this.access_token,\n        //             openid : this.openid,\n        //             channel_key : channel_key\n        //         },\n        //         success : getBalanceCB,\n        //         fail() {\n        //             persist.showTip('查询余额失败！请稍后重试')\n        //         }\n        //     })\n        // }\n        wx.checkSession({\n            success: (function () {\n                wx.request({\n                    url: 'https://tafang2center.ios.gzyouai.com:8091/service/wxGetBalance',\n                    data: {\n                        openid: this.openid,\n                        channel_key: channel_key,\n                        session_key: this.session_key,\n                        timestamp: Math.floor(Date.parse(new Date()) / 100)\n                    },\n                    success: getBalanceCB,\n                    fail() {\n                        persist.showTip('查询余额失败！请稍后重试')\n                    }\n                })\n            }).bind(this),\n            fail: (function () {\n                this.login()\n            }).bind(this)\n        })\n        // wx.request({\n        // url : 'https://tafang2center.ios.gzyouai.com:8091/service/wxAccessToken',\n        //     data : {\n        //         channel_key : channel_key\n        //     },\n        //     success : getTokenCB,\n        //     fail() {\n        //         persist.showTip('请求支付失败！请稍后重试')\n        //     }\n        // })\n        // wx.request({\n        //     url: notify_url,\n        //     data: {\n        //         'openid' : this.openid,\n        //         'pid' : pid,\n        //         'channel_key' : channel_key,\n        //         'server_id' : server_id,\n        //         'money' : price,\n        //         'storeName' : data.STORE_NAME,\n        //     },\n        //     success (res) {\n        //         console.log(\"支付订单生成\")\n        //         let timestamp = Math.floor(Date.parse(new Date())/100)\n        //         let data = res.data\n        //         if (res.statusCode == 200 && data.status == \"SUCCESS\") {\n        //             wx.requestPayment({\n        //                 'timeStamp': String(timestamp),\n        //                 'nonceStr': '',\n        //                 'package': '',\n        //                 'signType': 'MD5',\n        //                 'paySign': '',\n        //                 'success':function(res){\n        //                     persist.showTip('支付成功！')\n        //                 },\n        //             'fail':function(res){\n        //                 persist.showTip('支付失败！' + res.errMsg)\n        //             }\n        //         } else {\n\n        //         }\n        //     });\n        //     }\n        // })\n\n        return true\n    }\n    platformLoginServer(gameParams) {\n        let params = JSON.parse(gameParams)\n        this.server_id = params.SERVER_ID\n        this.pid = params.PLAYER_ID\n    }\n    rechargeResultCallback(money, unit, goods) {\n\n    }\n    showFloatingBall(isShow) {\n        if (this.ball == undefined) {\n            var screenSize = cc.view.getFrameSize();\n            this.ball = wx.createGameClubButton({\n                icon: 'green',\n                style: {\n                    left: screenSize.width - 50,\n                    top: 76,\n                    width: 40,\n                    height: 40\n                }\n            })\n        }\n        if (isShow) {\n            this.ball.show()\n        } else {\n            this.ball.hide()\n        }\n    }\n    shareUserData(datas) {\n        let KVList = []\n        let timestamp = Date.parse(new Date()) / 1000;\n        if (Array.isArray(datas)) {\n            for (var i = 0; i < datas.length; i++) {\n                let data = data[i]\n                KVList.push({\n                    key: data.key,\n                    value: JSON.stringify({ \"wxgame\": { \"score\": data.score, \"update_time\": timestamp }, \"playerlv\": pp.lv })\n                })\n            }\n        } else {\n            KVList.push({\n                key: datas.key,\n                value: JSON.stringify({ \"wxgame\": { \"score\": datas.score, \"update_time\": timestamp }, \"playerlv\": pp.lv })\n            })\n        }\n        wx.setUserCloudStorage({ KVDataList: KVList })\n    }\n\n    gc() {\n        wx.triggerGC()\n    }\n\n    postLoginData(data) {\n        let conf = gg.numerical.openPackage;\n\n        data.link_key = this.link_key\n        data.channel_key = conf.channel.substr(1, conf.channel.length - 1);\n        data.sign = gg.md5.hex_md5('wx009@qfgn@9527#009' + data.channel_key + data.link_key)//数据签名\n        let successCB = res => {\n            if (res.data.code) {\n                let link_key = this.link_key\n                let channel_key = gg.numerical.openPackage.channel.substr(1, conf.channel.length - 1);\n                wx.getSystemInfo({\n                    success: function (res) {\n                        wx.request({\n                            url: 'https://tafang2center.ios.gzyouai.com:8071/wx-sys-info',\n                            method: 'POST',\n                            data: { link_key: link_key, channel_key: channel_key, info: JSON.stringify(res) }\n                        })\n                    }\n                })\n            }\n        }\n        wx.request({\n            url: 'https://tafang2center.ios.gzyouai.com:8071/wx-login',\n            method: 'POST',\n            data: data,\n            success: successCB\n        })\n    }\n    initRewardedVideoAd(adUnitId) {\n        this.rewardedVideoAd = this.rewardedVideoAd || wx.createRewardedVideoAd({ adUnitId: adUnitId });\n        this.rewardedVideoAd.onError(() => {\n            this.loadVideoSuccess = false;\n        })\n        this.rewardedVideoAd.onLoad(() => {\n            this.loadVideoSuccess = true;\n        });\n    }\n    hideRewardedVideoAd() {\n        this.rewardedVideoAd && this.rewardedVideoAd.hide();\n    }\n    watchRewardedVideoAd() {\n        if (!this.rewardedVideoAd) return;\n\n        if (this.loadVideoSuccess) {\n            this.rewardedVideoAd.show().catch(err => { this.rewardedVideoAd.load().then(this.watchRewardedVideoAd()) });\n        } else {\n            this.rewardedVideoAd.load().then(() => {\n                this.watchRewardedVideoAd();\n            })\n        }\n    }\n    videoEndCallBack(successCb, failCb) {\n        this.rewardedVideoAd.onClose(\n            res => {\n                if (res && res.isEnded || res === undefined) {\n                    successCb && successCb();\n                } else {\n                    failCb && failCb();\n                    console.log(\"未看完广告，不能获得奖励\");\n                }\n            }\n        )\n    }\n    createUserInfoButton(_parent, onTapCallBack) {\n        var self = this;\n        if (typeof (wx) == 'undefined') {\n            return;\n        }\n        var systemInfo = 0;\n\n        var self = this;\n        var createButton = function () {\n            let button = wx.createUserInfoButton({\n                type: 'image',\n                // type: 'text',\n\n                // image: \"https://h5game-1255801610.cos.ap-shanghai.myqcloud.com/game/wxResorces/alpha.png\",\n                image: 'https://twzwcdn.ios.gzyouai.com/wxgame/image/userInfoBg.png',\n                // text: '授权',\n                style: {\n                    left: 0,\n                    top: 0,\n                    width: systemInfo.windowWidth,\n                    height: systemInfo.windowHeight,\n                    lineHeight: 40,\n                    backgroundColor: '#ff0000',\n                    color: '#ffffff',\n                    textAlign: 'center',\n                    fontSize: 16,\n                    borderRadius: 4\n                }\n            });\n            button.onTap((res) => {\n                if (res.errMsg != \"getUserInfo:ok\") return;\n                self.userInfo = res.userInfo;\n                console.log(\"获取授权信息 -> \", res);\n                if (typeof (onTapCallBack) == \"function\") {\n                    onTapCallBack();\n                }\n                button.destroy();\n            });\n            button.parent = _parent;\n        };\n\n\n        wx.getUserInfo({\n            success: function (res) {\n                if (typeof (onTapCallBack) == \"function\") {\n                    self.userInfo = res.userInfo;\n                    onTapCallBack();\n                }\n            },\n            fail: function () {\n                wx.getSystemInfo({\n                    success: function (res) {\n                        console.log(\"getSystemInfo\", res);\n                        systemInfo = res;\n                        createButton();\n                    }\n                });\n            }\n        })\n    }\n    isWeiXin() {\n        if (typeof (navigator) == 'undefined') {\n            return false;\n        }\n        var ua = navigator.userAgent.toLowerCase();\n        if (ua.indexOf('micromessenger') != -1) {\n            console.log(\"微信平台\");\n            return true;\n        } else {\n            return false;\n        }\n    }\n    createImage(node, url) {\n        if (typeof (wx) != 'undefined') {\n            var sprite = node.getComponent(cc.Sprite);\n            var size = {\n                width: node.width,\n                height: node.height\n            };\n            let image = wx.createImage();\n            image.onload = function () {\n                let texture = new cc.Texture2D();\n                texture.initWithElement(image);\n                texture.handleLoadedTexture();\n                sprite.spriteFrame = new cc.SpriteFrame(texture);\n                node.width = size.width;\n                node.height = size.height;\n            };\n            image.src = url;\n        }\n    }\n}\n\nmodule.exports = new wechat();"]}